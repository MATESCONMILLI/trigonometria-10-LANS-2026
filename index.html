<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TrigonometrÃ­a 10Â° â€” Longitud de Arco y Sector Circular</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Source+Serif+4:ital,wght@0,300;0,400;0,600;1,300&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #1a1208;
    --paper: #faf7f2;
    --cream: #f2ebe0;
    --sienna: #8b3a1a;
    --gold: #c8972a;
    --sage: #4a7c59;
    --slate: #3d5a6e;
    --error: #9b2335;
    --success: #2d6a4f;
    --border: #c4b49a;
    --shadow: rgba(26,18,8,0.15);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Source Serif 4', Georgia, serif;
    background: var(--paper);
    color: var(--ink);
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
  }

  /* Ruled paper texture */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: 
      repeating-linear-gradient(
        transparent,
        transparent 31px,
        rgba(180,160,120,0.15) 31px,
        rgba(180,160,120,0.15) 32px
      ),
      linear-gradient(90deg, transparent 72px, rgba(180,100,80,0.12) 72px, rgba(180,100,80,0.12) 73px, transparent 73px);
    pointer-events: none;
    z-index: 0;
  }

  .app-wrapper {
    position: relative;
    z-index: 1;
    max-width: 860px;
    margin: 0 auto;
    padding: 32px 20px 60px;
  }

  /* â”€â”€ HEADER â”€â”€ */
  header {
    text-align: center;
    margin-bottom: 40px;
    border-bottom: 3px double var(--border);
    padding-bottom: 28px;
  }
  .school-tag {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--sienna);
    margin-bottom: 10px;
  }
  header h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(1.8rem, 5vw, 3rem);
    font-weight: 900;
    line-height: 1.1;
    color: var(--ink);
    margin-bottom: 8px;
  }
  header h1 span { color: var(--sienna); }
  header p {
    font-style: italic;
    font-weight: 300;
    color: #6b5a40;
    font-size: 1rem;
  }

  /* â”€â”€ STUDENT FORM â”€â”€ */
  #student-form-section {
    background: var(--cream);
    border: 1.5px solid var(--border);
    border-radius: 4px;
    padding: 28px 32px;
    margin-bottom: 32px;
    box-shadow: 3px 3px 0 var(--shadow);
  }
  #student-form-section h2 {
    font-family: 'Playfair Display', serif;
    font-size: 1.2rem;
    color: var(--sienna);
    margin-bottom: 18px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
    margin-bottom: 18px;
  }
  @media(max-width:520px){ .form-grid { grid-template-columns: 1fr; } }
  .form-group label {
    display: block;
    font-size: 0.78rem;
    font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--sienna);
    margin-bottom: 4px;
  }
  .form-group input, .form-group select {
    width: 100%;
    padding: 9px 12px;
    border: 1.5px solid var(--border);
    background: var(--paper);
    font-family: 'Source Serif 4', serif;
    font-size: 0.95rem;
    color: var(--ink);
    border-radius: 2px;
    outline: none;
    transition: border-color .2s;
  }
  .form-group input:focus, .form-group select:focus { border-color: var(--gold); }

  /* â”€â”€ PROGRESS BAR â”€â”€ */
  .progress-area {
    display: none;
    margin-bottom: 28px;
    align-items: center;
    gap: 14px;
  }
  .progress-area.visible { display: flex; }
  .progress-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    color: var(--sienna);
    white-space: nowrap;
  }
  .progress-track {
    flex: 1;
    height: 8px;
    background: var(--cream);
    border: 1px solid var(--border);
    border-radius: 4px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--sienna), var(--gold));
    border-radius: 4px;
    transition: width 0.5s cubic-bezier(.4,0,.2,1);
    width: 0%;
  }
  .progress-count {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--ink);
    min-width: 40px;
    text-align: right;
  }

  /* â”€â”€ SECTION LABELS â”€â”€ */
  .section-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--paper);
    background: var(--sienna);
    display: inline-block;
    padding: 4px 12px;
    margin-bottom: 16px;
    border-radius: 2px;
  }
  .section-label.arc { background: var(--slate); }
  .section-label.sector { background: var(--sage); }

  /* â”€â”€ QUESTION CARD â”€â”€ */
  .question-card {
    background: var(--cream);
    border: 1.5px solid var(--border);
    border-radius: 4px;
    padding: 26px 28px;
    margin-bottom: 20px;
    box-shadow: 3px 3px 0 var(--shadow);
    position: relative;
    transition: opacity 0.3s;
  }
  .question-card.locked { opacity: 0.55; pointer-events: none; }
  .question-card.answered { border-color: var(--border); }

  .q-number {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    font-weight: 900;
    color: rgba(26,18,8,0.08);
    position: absolute;
    top: 10px;
    right: 20px;
    line-height: 1;
  }
  .q-type {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.65rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 8px;
    display: block;
  }
  .q-text {
    font-size: 1.05rem;
    line-height: 1.65;
    margin-bottom: 20px;
    color: var(--ink);
  }
  .q-text .formula {
    font-family: 'JetBrains Mono', monospace;
    background: rgba(200,151,42,0.12);
    padding: 2px 6px;
    border-radius: 2px;
    font-size: 0.95em;
  }

  /* â”€â”€ OPTIONS â”€â”€ */
  .options-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 16px;
  }
  @media(max-width:480px){ .options-grid { grid-template-columns: 1fr; } }

  .option-btn {
    position: relative;
    background: var(--paper);
    border: 1.5px solid var(--border);
    border-radius: 3px;
    padding: 12px 16px 12px 44px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.92rem;
    color: var(--ink);
    cursor: pointer;
    text-align: left;
    transition: all .18s;
    line-height: 1.4;
  }
  .option-btn:hover:not(:disabled) {
    background: rgba(200,151,42,0.08);
    border-color: var(--gold);
    transform: translateX(2px);
  }
  .option-label {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: var(--cream);
    border: 1.5px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--sienna);
    transition: all .18s;
  }
  .option-btn:hover:not(:disabled) .option-label {
    background: var(--gold);
    border-color: var(--gold);
    color: white;
  }
  .option-btn.correct {
    background: rgba(45,106,79,0.1);
    border-color: var(--success);
    color: var(--success);
  }
  .option-btn.correct .option-label {
    background: var(--success);
    border-color: var(--success);
    color: white;
  }
  .option-btn.wrong {
    background: rgba(155,35,53,0.08);
    border-color: var(--error);
    color: var(--error);
    text-decoration: line-through;
    text-decoration-color: rgba(155,35,53,0.4);
  }
  .option-btn.wrong .option-label {
    background: var(--error);
    border-color: var(--error);
    color: white;
  }
  .option-btn.reveal-correct {
    background: rgba(45,106,79,0.06);
    border-color: var(--success);
    color: var(--success);
  }
  .option-btn:disabled { cursor: default; }

  /* â”€â”€ FEEDBACK â”€â”€ */
  .feedback-box {
    display: none;
    border-left: 4px solid var(--success);
    background: rgba(45,106,79,0.07);
    padding: 14px 16px;
    border-radius: 0 3px 3px 0;
    margin-top: 12px;
    font-size: 0.92rem;
    line-height: 1.65;
    color: var(--ink);
  }
  .feedback-box.wrong-fb {
    border-color: var(--error);
    background: rgba(155,35,53,0.06);
  }
  .feedback-box.visible { display: block; }
  .feedback-title {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    font-weight: 600;
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .feedback-title.ok { color: var(--success); }
  .feedback-title.nok { color: var(--error); }
  .feedback-box code {
    font-family: 'JetBrains Mono', monospace;
    background: rgba(26,18,8,0.07);
    padding: 1px 5px;
    border-radius: 2px;
    font-size: 0.9em;
  }

  /* â”€â”€ BUTTONS â”€â”€ */
  .btn {
    font-family: 'Source Serif 4', serif;
    font-size: 1rem;
    padding: 12px 28px;
    border-radius: 3px;
    border: none;
    cursor: pointer;
    transition: all .18s;
    letter-spacing: 0.03em;
  }
  .btn-primary {
    background: var(--sienna);
    color: white;
    box-shadow: 3px 3px 0 rgba(139,58,26,0.3);
  }
  .btn-primary:hover { background: #7a3318; transform: translate(-1px,-1px); box-shadow: 4px 4px 0 rgba(139,58,26,0.3); }
  .btn-primary:active { transform: translate(1px,1px); box-shadow: 1px 1px 0 rgba(139,58,26,0.3); }
  .btn-secondary {
    background: transparent;
    color: var(--slate);
    border: 1.5px solid var(--slate);
  }
  .btn-secondary:hover { background: var(--slate); color: white; }

  /* â”€â”€ RESULTS PANEL â”€â”€ */
  #results-section {
    display: none;
    background: var(--cream);
    border: 1.5px solid var(--border);
    border-radius: 4px;
    padding: 32px;
    margin-top: 32px;
    box-shadow: 3px 3px 0 var(--shadow);
  }
  #results-section h2 {
    font-family: 'Playfair Display', serif;
    font-size: 1.8rem;
    font-weight: 900;
    color: var(--sienna);
    margin-bottom: 24px;
    border-bottom: 2px solid var(--border);
    padding-bottom: 14px;
  }
  .score-display {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 28px;
    flex-wrap: wrap;
  }
  .score-circle {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: var(--sienna);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 4px 4px 0 rgba(139,58,26,0.25);
  }
  .score-circle .score-num {
    font-family: 'Playfair Display', serif;
    font-size: 2.2rem;
    font-weight: 900;
    line-height: 1;
  }
  .score-circle .score-den {
    font-size: 0.75rem;
    opacity: 0.8;
    letter-spacing: 0.05em;
  }
  .score-breakdown { flex: 1; min-width: 200px; }
  .score-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 0;
    border-bottom: 1px dashed var(--border);
    font-size: 0.92rem;
  }
  .score-row:last-child { border: none; }
  .score-row strong { font-weight: 600; }
  .badge-ok { color: var(--success); font-weight: 700; }
  .badge-nok { color: var(--error); font-weight: 700; }

  .result-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.88rem;
    margin-bottom: 24px;
  }
  .result-table th {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--sienna);
    padding: 8px 12px;
    text-align: left;
    border-bottom: 2px solid var(--border);
    background: rgba(200,151,42,0.08);
  }
  .result-table td {
    padding: 8px 12px;
    border-bottom: 1px solid rgba(196,180,154,0.5);
    vertical-align: top;
  }
  .result-table tr:last-child td { border-bottom: none; }
  .result-table tr:hover td { background: rgba(200,151,42,0.05); }
  .status-ok { color: var(--success); font-weight: 700; }
  .status-nok { color: var(--error); font-weight: 700; }

  .actions-row {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  /* â”€â”€ MATH NOTATION â”€â”€ */
  .math {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.95em;
  }
  sup { font-size: 0.7em; vertical-align: super; }
  sub { font-size: 0.7em; vertical-align: sub; }

  /* â”€â”€ DIVIDERS â”€â”€ */
  .section-divider {
    text-align: center;
    margin: 36px 0 24px;
    position: relative;
  }
  .section-divider::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0; right: 0;
    height: 1px;
    background: var(--border);
  }
  .section-divider span {
    position: relative;
    background: var(--paper);
    padding: 0 16px;
    font-family: 'Playfair Display', serif;
    font-style: italic;
    color: var(--sienna);
    font-size: 1rem;
  }

  /* â”€â”€ FORMULA REFERENCE â”€â”€ */
  .formula-ref {
    background: rgba(61,90,110,0.07);
    border: 1px solid rgba(61,90,110,0.2);
    border-radius: 3px;
    padding: 10px 16px;
    margin-bottom: 24px;
    font-size: 0.88rem;
    color: var(--slate);
    display: flex;
    gap: 24px;
    flex-wrap: wrap;
  }
  .formula-ref span { font-family: 'JetBrains Mono', monospace; }

  /* Animations */
  @keyframes slideIn {
    from { opacity:0; transform: translateY(8px); }
    to { opacity:1; transform: translateY(0); }
  }
  .question-card { animation: slideIn 0.3s ease both; }
  #results-section { animation: slideIn 0.4s ease both; }

  .toast {
    position: fixed;
    bottom: 24px;
    right: 24px;
    background: var(--ink);
    color: var(--paper);
    padding: 12px 20px;
    border-radius: 3px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    z-index: 999;
    animation: slideIn 0.3s ease;
    display: none;
  }

  .submit-row {
    text-align: center;
    margin-top: 28px;
    display: none;
  }

  /* â”€â”€ AUTHOR CREDIT (header) â”€â”€ */
  .author-credit {
    margin-top: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    flex-wrap: wrap;
    padding-top: 12px;
    border-top: 1px dashed var(--border);
  }
  .author-name {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 0.9rem;
    color: var(--sienna);
    letter-spacing: 0.03em;
  }
  .author-inst {
    font-family: 'Source Serif 4', serif;
    font-style: italic;
    font-size: 0.85rem;
    color: #5a4a30;
  }
  .author-city {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--gold);
  }
  .author-sep {
    color: var(--border);
    font-size: 0.85rem;
  }

  /* â”€â”€ FOOTER â”€â”€ */
  .app-footer {
    position: relative;
    z-index: 1;
    margin-top: 56px;
    border-top: 3px double var(--border);
    background: var(--cream);
  }
  .footer-inner {
    max-width: 860px;
    margin: 0 auto;
    padding: 20px 24px;
    display: flex;
    align-items: center;
    gap: 16px;
    flex-wrap: wrap;
  }
  .footer-logo {
    font-size: 1.4rem;
    color: var(--gold);
    flex-shrink: 0;
  }
  .footer-text {
    flex: 1;
    font-size: 0.85rem;
    line-height: 1.6;
    color: var(--ink);
  }
  .footer-text strong {
    font-family: 'Playfair Display', serif;
    font-size: 0.95rem;
    color: var(--sienna);
    display: block;
  }
  .footer-subject {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gold);
    border-left: 2px solid var(--border);
    padding-left: 14px;
  }
</style>
</head>
<body>
<div class="app-wrapper">

  <!-- HEADER -->
  <header>
    <div class="school-tag">MatemÃ¡ticas Â· Grado 10Â° Â· TrigonometrÃ­a</div>
    <h1>Longitud de Arco<br><span>&</span> Sector Circular</h1>
    <p>Cuestionario interactivo â€” sin calculadora Â· respuestas exactas</p>
    <div class="author-credit">
      <span class="author-name">Luis Jorge MillÃ¡n Bustamante</span>
      <span class="author-sep">Â·</span>
      <span class="author-inst">Liceo Arquidiocesano de Nuestra SeÃ±ora</span>
      <span class="author-sep">Â·</span>
      <span class="author-city">Manizales</span>
    </div>
  </header>

  <!-- STUDENT FORM -->
  <div id="student-form-section">
    <h2>âœ Datos del Estudiante</h2>
    <div class="form-grid">
      <div class="form-group">
        <label>Nombre completo</label>
        <input type="text" id="studentName" placeholder="Ej. Ana GarcÃ­a PÃ©rez">
      </div>
      <div class="form-group">
        <label>CÃ³digo / NÃºmero de lista</label>
        <input type="text" id="studentCode" placeholder="Ej. 1035">
      </div>
      <div class="form-group">
        <label>Grado y grupo</label>
        <input type="text" id="studentGroup" placeholder="Ej. 10-B">
      </div>
      <div class="form-group">
        <label>Fecha</label>
        <input type="date" id="studentDate">
      </div>
    </div>
    <button class="btn btn-primary" onclick="startQuiz()">Iniciar evaluaciÃ³n â†’</button>
  </div>

  <!-- PROGRESS -->
  <div class="progress-area" id="progressArea">
    <span class="progress-label">Avance</span>
    <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
    <span class="progress-count" id="progressCount">0/10</span>
  </div>

  <!-- FORMULA REF -->
  <div class="formula-ref" id="formulaRef" style="display:none">
    <div><strong>Longitud de arco (Î¸ en grados):</strong> <span>s = (Î¸/360Â°) Â· 2Ï€r</span></div>
    <div><strong>Ãrea de sector (Î¸ en grados):</strong> <span>A = (Î¸/360Â°) Â· Ï€rÂ²</span></div>
  </div>

  <!-- QUIZ CONTAINER -->
  <div id="quiz-container"></div>

  <!-- SUBMIT -->
  <div class="submit-row" id="submitRow">
    <button class="btn btn-primary" onclick="showResults()" id="submitBtn" disabled>
      Ver resultados completos â†’
    </button>
  </div>

  <!-- RESULTS -->
  <div id="results-section">
    <h2>Resultados de la EvaluaciÃ³n</h2>
    <div class="score-display">
      <div class="score-circle">
        <div class="score-num" id="scoreNum">0</div>
        <div class="score-den">de 10</div>
      </div>
      <div class="score-breakdown">
        <div class="score-row">
          <span>Longitud de arco</span><strong id="arcScore">0/5</strong>
        </div>
        <div class="score-row">
          <span>Ãrea de sector</span><strong id="sectorScore">0/5</strong>
        </div>
        <div class="score-row">
          <span>Respuestas correctas</span><strong id="totalCorrect" class="badge-ok">0</strong>
        </div>
        <div class="score-row">
          <span>Respuestas incorrectas</span><strong id="totalWrong" class="badge-nok">0</strong>
        </div>
        <div class="score-row">
          <span>Nota</span><strong id="nota" style="color:var(--gold)">â€”</strong>
        </div>
      </div>
    </div>
    <table class="result-table">
      <thead><tr>
        <th>#</th><th>Pregunta</th><th>Tu respuesta</th><th>Correcta</th><th>Estado</th>
      </tr></thead>
      <tbody id="resultTableBody"></tbody>
    </table>
    <div class="actions-row">
      <button class="btn btn-primary" onclick="downloadExcel()">ğŸ“¥ Descargar resultados Excel</button>
      <button class="btn btn-secondary" onclick="resetQuiz()">â†© Nueva evaluaciÃ³n</button>
    </div>
  </div>

</div><!-- /app-wrapper -->
<div class="toast" id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BANK OF QUESTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€â”€ VERIFICACIÃ“N MATEMÃTICA (Ã¡ngulos en grados) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// FÃ³rmulas:  s = (Î¸/360)Â·2Ï€r   |   r = sÂ·360/(2Ï€Î¸)   |   Î¸ = sÂ·360/(2Ï€r)
//            A = (Î¸/360)Â·Ï€rÂ²   |   r = âˆš(360A/(Ï€Î¸))  |   Î¸ = 360A/(Ï€rÂ²)
//
// LONGITUD DE ARCO
// P1 (hallar s): Î¸=60Â°,  r=9 cm  â†’ s = (1/6)Â·18Ï€ = 3Ï€ cm             âœ”
// P2 (hallar s): Î¸=120Â°, r=6 m   â†’ s = (1/3)Â·12Ï€ = 4Ï€ m              âœ”
// P3 (hallar r): Î¸=90Â°,  s=6Ï€ m  â†’ r = 6Ï€Â·360/(2Ï€Â·90) = 6Ï€Â·2/Ï€ = 12 m âœ”
// P4 (hallar r): Î¸=45Â°,  s=3Ï€ cm â†’ r = 3Ï€Â·360/(2Ï€Â·45) = 3Ï€Â·4/Ï€ = 12 cm âœ”
// P5 (hallar Î¸): r=5 cm, s=5Ï€ cm â†’ Î¸ = 5Ï€Â·360/(2Ï€Â·5) = 5Ï€Â·36/Ï€ = 180Â° âœ”
//
// ÃREA DE SECTOR CIRCULAR
// P6  (hallar A): Î¸=90Â°,  r=8 cm  â†’ A = (1/4)Â·64Ï€ = 16Ï€ cmÂ²          âœ”
// P7  (hallar A): Î¸=120Â°, r=9 m   â†’ A = (1/3)Â·81Ï€ = 27Ï€ mÂ²           âœ”
// P8  (hallar r): Î¸=60Â°,  A=6Ï€ mÂ² â†’ rÂ² = 6Ï€Â·6/Ï€ = 36 â†’ r = 6 m       âœ”
// P9  (hallar r): Î¸=90Â°,  A=25Ï€ cmÂ² â†’ rÂ² = 25Ï€Â·4/Ï€ = 100 â†’ r = 10 cm âœ”
// P10 (hallar Î¸): r=6 cm, A=12Ï€ cmÂ² â†’ Î¸ = 12Ï€Â·360/(Ï€Â·36) = 120Â°       âœ”
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const ARC_QUESTIONS = [
  {
    // P1 â€” HALLAR s
    type: "arc",
    subtipo: "Hallar s",
    question: "Un cÃ­rculo tiene radio <span class='formula'>r = 9</span> cm y Ã¡ngulo central <span class='formula'>Î¸ = 60Â°</span>. Halla la longitud del arco <span class='formula'>s</span>.",
    options: ["3Ï€ cm", "9Ï€ cm", "6Ï€ cm", "18Ï€ cm"],
    answer: 0,
    correct_label: "3Ï€ cm",
    feedback_correct: "âœ” Correcto. Usando <code>s = (Î¸/360Â°)Â·2Ï€r = (60/360)Â·2Ï€Â·9 = (1/6)Â·18Ï€ = 3Ï€</code> cm. El Ã¡ngulo 60Â° es 1/6 de la vuelta completa, por lo que el arco es 1/6 de la circunferencia total <code>2Ï€Â·9 = 18Ï€</code>.",
    feedback_wrong: "âœ˜ Aplica <code>s = (Î¸/360Â°)Â·2Ï€r</code>. Con Î¸ = 60Â° y r = 9 cm: <code>s = (60/360)Â·2Ï€Â·9 = (1/6)Â·18Ï€ = 3Ï€</code> cm. Primero simplifica 60/360 = 1/6, luego multiplica por 18Ï€."
  },
  {
    // P2 â€” HALLAR s
    type: "arc",
    subtipo: "Hallar s",
    question: "Calcula la longitud del arco <span class='formula'>s</span> de un cÃ­rculo de radio <span class='formula'>r = 6</span> m con Ã¡ngulo central <span class='formula'>Î¸ = 120Â°</span>.",
    options: ["4Ï€ m", "12Ï€ m", "2Ï€ m", "8Ï€ m"],
    answer: 0,
    correct_label: "4Ï€ m",
    feedback_correct: "âœ” Correcto. <code>s = (120/360)Â·2Ï€Â·6 = (1/3)Â·12Ï€ = 4Ï€</code> m. Un Ã¡ngulo de 120Â° es 1/3 del cÃ­rculo; por tanto el arco es 1/3 de la circunferencia <code>2Ï€Â·6 = 12Ï€</code>.",
    feedback_wrong: "âœ˜ <code>s = (120/360)Â·2Ï€Â·6 = (1/3)Â·12Ï€ = 4Ï€</code> m. Recuerda: 120/360 = 1/3. Luego 1/3 Ã— 12Ï€ = 4Ï€."
  },
  {
    // P3 â€” HALLAR r
    type: "arc",
    subtipo: "Hallar r",
    question: "Un arco de longitud <span class='formula'>s = 6Ï€</span> m corresponde a un Ã¡ngulo central <span class='formula'>Î¸ = 90Â°</span>. Â¿CuÃ¡l es el radio <span class='formula'>r</span> del cÃ­rculo?",
    options: ["12 m", "6 m", "3 m", "24 m"],
    answer: 0,
    correct_label: "12 m",
    feedback_correct: "âœ” Correcto. De <code>s = (Î¸/360Â°)Â·2Ï€r</code> se despeja: <code>r = sÂ·360/(2Ï€Î¸) = 6Ï€Â·360/(2Ï€Â·90) = 6Ï€Â·360/180Ï€ = 6Â·2 = 12</code> m. Simplifica primero 360/180 = 2, luego 6Ï€Â·2/Ï€ = 12.",
    feedback_wrong: "âœ˜ Despeja r de <code>s = (90/360)Â·2Ï€r = (1/4)Â·2Ï€r</code>: entonces <code>6Ï€ = Ï€r/2 â†’ r = 12Ï€/Ï€ = 12</code> m. Sustituye s = 6Ï€ y Î¸ = 90Â°, luego despeja r."
  },
  {
    // P4 â€” HALLAR r
    type: "arc",
    subtipo: "Hallar r",
    question: "La longitud de un arco es <span class='formula'>s = 3Ï€</span> cm y el Ã¡ngulo central que lo subtende mide <span class='formula'>Î¸ = 45Â°</span>. Determina el radio <span class='formula'>r</span>.",
    options: ["12 cm", "6 cm", "3 cm", "24 cm"],
    answer: 0,
    correct_label: "12 cm",
    feedback_correct: "âœ” Correcto. Con Î¸ = 45Â° = 1/8 de la vuelta: <code>s = (1/8)Â·2Ï€r â†’ 3Ï€ = Ï€r/4 â†’ r = 12Ï€/Ï€ = 12</code> cm. Despeja r multiplicando ambos lados por 4 y dividiendo entre Ï€.",
    feedback_wrong: "âœ˜ Como Î¸ = 45Â° = 1/8 del cÃ­rculo, <code>s = (1/8)Â·2Ï€r â†’ 3Ï€ = Ï€r/4 â†’ r = 12</code> cm. Recuerda despejar r: multiplica por 4 y cancela Ï€ de ambos lados."
  },
  {
    // P5 â€” HALLAR Î¸
    type: "arc",
    subtipo: "Hallar Î¸",
    question: "En un cÃ­rculo de radio <span class='formula'>r = 5</span> cm, un arco mide <span class='formula'>s = 5Ï€</span> cm. Â¿CuÃ¡nto mide el Ã¡ngulo central <span class='formula'>Î¸</span>?",
    options: ["180Â°", "90Â°", "270Â°", "60Â°"],
    answer: 0,
    correct_label: "180Â°",
    feedback_correct: "âœ” Correcto. De <code>s = (Î¸/360Â°)Â·2Ï€r</code>: <code>Î¸ = sÂ·360/(2Ï€r) = 5Ï€Â·360/(2Ï€Â·5) = 5Ï€Â·360/10Ï€ = 360/2 = 180Â°</code>. El arco 5Ï€ es exactamente la mitad de la circunferencia <code>2Ï€Â·5 = 10Ï€</code>.",
    feedback_wrong: "âœ˜ Despeja Î¸: <code>Î¸ = sÂ·360/(2Ï€r) = 5Ï€Â·360/(10Ï€) = 1800/10 = 180Â°</code>. El arco 5Ï€ es la mitad de la circunferencia completa 10Ï€, por eso el Ã¡ngulo central es 180Â°."
  }
];

const SECTOR_QUESTIONS = [
  {
    // P6 â€” HALLAR A
    type: "sector",
    subtipo: "Hallar A",
    question: "Halla el Ã¡rea del sector circular con radio <span class='formula'>r = 8</span> cm y Ã¡ngulo central <span class='formula'>Î¸ = 90Â°</span>.",
    options: ["16Ï€ cmÂ²", "32Ï€ cmÂ²", "8Ï€ cmÂ²", "64Ï€ cmÂ²"],
    answer: 0,
    correct_label: "16Ï€ cmÂ²",
    feedback_correct: "âœ” Correcto. <code>A = (90/360)Â·Ï€Â·8Â² = (1/4)Â·64Ï€ = 16Ï€</code> cmÂ². Un Ã¡ngulo de 90Â° es 1/4 del cÃ­rculo; el Ã¡rea del sector es 1/4 del Ã¡rea total <code>Ï€Â·64 = 64Ï€</code>.",
    feedback_wrong: "âœ˜ Usa <code>A = (Î¸/360Â°)Â·Ï€rÂ²</code>: <code>A = (90/360)Â·Ï€Â·64 = (1/4)Â·64Ï€ = 16Ï€</code> cmÂ². Calcula primero rÂ² = 64, luego multiplica por 1/4."
  },
  {
    // P7 â€” HALLAR A
    type: "sector",
    subtipo: "Hallar A",
    question: "Determina el Ã¡rea del sector circular con radio <span class='formula'>r = 9</span> m y Ã¡ngulo central <span class='formula'>Î¸ = 120Â°</span>.",
    options: ["27Ï€ mÂ²", "81Ï€ mÂ²", "9Ï€ mÂ²", "54Ï€ mÂ²"],
    answer: 0,
    correct_label: "27Ï€ mÂ²",
    feedback_correct: "âœ” Correcto. <code>A = (120/360)Â·Ï€Â·9Â² = (1/3)Â·81Ï€ = 27Ï€</code> mÂ². El Ã¡ngulo 120Â° es 1/3 del cÃ­rculo; el Ã¡rea es 1/3 de <code>Ï€Â·81 = 81Ï€</code>.",
    feedback_wrong: "âœ˜ <code>A = (120/360)Â·Ï€Â·81 = (1/3)Â·81Ï€ = 27Ï€</code> mÂ². Simplifica: 120/360 = 1/3, luego 81Ï€/3 = 27Ï€."
  },
  {
    // P8 â€” HALLAR r
    type: "sector",
    subtipo: "Hallar r",
    question: "El Ã¡rea de un sector circular es <span class='formula'>A = 6Ï€</span> mÂ² y su Ã¡ngulo central mide <span class='formula'>Î¸ = 60Â°</span>. Calcula el radio <span class='formula'>r</span>.",
    options: ["6 m", "3 m", "âˆš6 m", "12 m"],
    answer: 0,
    correct_label: "6 m",
    feedback_correct: "âœ” Correcto. De <code>A = (Î¸/360Â°)Â·Ï€rÂ²</code>: <code>6Ï€ = (1/6)Â·Ï€rÂ² â†’ rÂ² = 36Ï€/Ï€ = 36 â†’ r = 6</code> m. Despeja rÂ²: multiplica ambos lados por 6 y cancela Ï€.",
    feedback_wrong: "âœ˜ De <code>6Ï€ = (60/360)Â·Ï€rÂ² = (1/6)Ï€rÂ²</code> se despeja: <code>rÂ² = 6Ï€Â·6/Ï€ = 36 â†’ r = 6</code> m. Multiplica por 6 y cancela Ï€ para hallar rÂ²."
  },
  {
    // P9 â€” HALLAR r
    type: "sector",
    subtipo: "Hallar r",
    question: "Un sector circular tiene Ã¡rea <span class='formula'>A = 25Ï€</span> cmÂ² y Ã¡ngulo central <span class='formula'>Î¸ = 90Â°</span>. Â¿CuÃ¡nto mide el radio <span class='formula'>r</span>?",
    options: ["10 cm", "5 cm", "25 cm", "âˆš25Ï€ cm"],
    answer: 0,
    correct_label: "10 cm",
    feedback_correct: "âœ” Correcto. <code>25Ï€ = (1/4)Â·Ï€rÂ² â†’ rÂ² = 100Ï€/Ï€ = 100 â†’ r = 10</code> cm. Multiplica ambos lados por 4 y cancela Ï€: <code>rÂ² = 100</code>, por tanto <code>r = 10</code>.",
    feedback_wrong: "âœ˜ <code>25Ï€ = (90/360)Â·Ï€rÂ² = (1/4)Ï€rÂ² â†’ rÂ² = 100 â†’ r = 10</code> cm. Despeja rÂ²: multiplica por 4 y divide entre Ï€. Luego saca raÃ­z cuadrada."
  },
  {
    // P10 â€” HALLAR Î¸
    type: "sector",
    subtipo: "Hallar Î¸",
    question: "Un sector circular de radio <span class='formula'>r = 6</span> cm tiene Ã¡rea <span class='formula'>A = 12Ï€</span> cmÂ². Â¿CuÃ¡nto mide el Ã¡ngulo central <span class='formula'>Î¸</span>?",
    options: ["120Â°", "60Â°", "90Â°", "180Â°"],
    answer: 0,
    correct_label: "120Â°",
    feedback_correct: "âœ” Correcto. De <code>A = (Î¸/360Â°)Â·Ï€rÂ²</code>: <code>Î¸ = AÂ·360/(Ï€rÂ²) = 12Ï€Â·360/(Ï€Â·36) = 12Â·360/36 = 120Â°</code>. Cancela Ï€ y simplifica: 12Â·360/36 = 12Â·10 = 120.",
    feedback_wrong: "âœ˜ Despeja Î¸: <code>Î¸ = AÂ·360/(Ï€rÂ²) = 12Ï€Â·360/(Ï€Â·36) = 4320Ï€/36Ï€ = 120Â°</code>. Cancela Ï€ en numerador y denominador, luego divide: 4320/36 = 120."
  }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUIZ STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const ALL_QUESTIONS = [...ARC_QUESTIONS, ...SECTOR_QUESTIONS];
let answered = new Array(10).fill(null); // null | { selected, correct }
let studentData = {};

function startQuiz() {
  const name = document.getElementById('studentName').value.trim();
  const code = document.getElementById('studentCode').value.trim();
  const group = document.getElementById('studentGroup').value.trim();
  const date = document.getElementById('studentDate').value;

  if (!name) { showToast('Escribe tu nombre completo'); return; }

  studentData = { name, code, group, date: date || new Date().toISOString().slice(0,10) };

  document.getElementById('student-form-section').style.display = 'none';
  document.getElementById('progressArea').classList.add('visible');
  document.getElementById('formulaRef').style.display = 'flex';
  document.getElementById('submitRow').style.display = 'block';

  renderQuestions();
  updateProgress();
}

function renderQuestions() {
  const container = document.getElementById('quiz-container');
  container.innerHTML = '';

  // Arc section
  const arcLabel = document.createElement('div');
  arcLabel.className = 'section-label arc';
  arcLabel.textContent = 'Parte I Â· Longitud de Arco';
  container.appendChild(arcLabel);

  for (let i = 0; i < 5; i++) {
    container.appendChild(buildCard(i, ALL_QUESTIONS[i]));
  }

  const divider = document.createElement('div');
  divider.className = 'section-divider';
  divider.innerHTML = '<span>â€” Ãrea de Sector Circular â€”</span>';
  container.appendChild(divider);

  const secLabel = document.createElement('div');
  secLabel.className = 'section-label sector';
  secLabel.textContent = 'Parte II Â· Ãrea de Sector Circular';
  container.appendChild(secLabel);

  for (let i = 5; i < 10; i++) {
    container.appendChild(buildCard(i, ALL_QUESTIONS[i]));
  }
}

function buildCard(idx, q) {
  const card = document.createElement('div');
  card.className = 'question-card';
  card.id = `card-${idx}`;

  const letters = ['A','B','C','D'];
  const optHtml = q.options.map((opt, oi) =>
    `<button class="option-btn" id="opt-${idx}-${oi}" onclick="selectOption(${idx},${oi})">
      <span class="option-label">${letters[oi]}</span>${opt}
    </button>`
  ).join('');

  const subtag = q.subtipo ? ` Â· Hallar <em>${q.subtipo.replace('Hallar ','')}</em>` : '';
  card.innerHTML = `
    <div class="q-number">${idx+1}</div>
    <span class="q-type">${idx < 5 ? 'ğŸ”µ Longitud de arco' : 'ğŸŸ¢ Ãrea de sector'}${subtag} Â· Pregunta ${idx+1}</span>
    <div class="q-text">${q.question}</div>
    <div class="options-grid">${optHtml}</div>
    <div class="feedback-box" id="fb-${idx}"></div>
  `;
  return card;
}

function selectOption(qIdx, optIdx) {
  if (answered[qIdx] !== null) return; // already answered

  const q = ALL_QUESTIONS[qIdx];
  const isCorrect = (optIdx === q.answer);

  answered[qIdx] = { selected: optIdx, correct: isCorrect };

  // Disable all options in this card
  for (let i = 0; i < q.options.length; i++) {
    const btn = document.getElementById(`opt-${qIdx}-${i}`);
    btn.disabled = true;
    if (i === q.answer) btn.classList.add('reveal-correct');
  }

  const selectedBtn = document.getElementById(`opt-${qIdx}-${optIdx}`);
  if (isCorrect) {
    selectedBtn.classList.remove('reveal-correct');
    selectedBtn.classList.add('correct');
  } else {
    selectedBtn.classList.add('wrong');
  }

  // Show feedback
  const fb = document.getElementById(`fb-${qIdx}`);
  fb.className = `feedback-box visible${isCorrect ? '' : ' wrong-fb'}`;
  fb.innerHTML = `
    <div class="feedback-title ${isCorrect ? 'ok' : 'nok'}">
      ${isCorrect ? 'âœ” Â¡Correcto!' : 'âœ˜ Incorrecto'}
    </div>
    <div>${isCorrect ? q.feedback_correct : q.feedback_wrong}</div>
  `;

  updateProgress();
  checkAllAnswered();
}

function updateProgress() {
  const done = answered.filter(a => a !== null).length;
  const pct = done / 10 * 100;
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressCount').textContent = `${done}/10`;
}

function checkAllAnswered() {
  const done = answered.filter(a => a !== null).length;
  document.getElementById('submitBtn').disabled = (done < 10);
  if (done === 10) {
    showToast('Â¡Respondiste todas las preguntas! Puedes ver tus resultados.');
  }
}

function showResults() {
  const correct = answered.filter(a => a && a.correct).length;
  const arcCorrect = answered.slice(0,5).filter(a => a && a.correct).length;
  const secCorrect = answered.slice(5,10).filter(a => a && a.correct).length;
  const nota = (correct / 10 * 5).toFixed(1);

  document.getElementById('scoreNum').textContent = correct;
  document.getElementById('arcScore').textContent = `${arcCorrect}/5`;
  document.getElementById('sectorScore').textContent = `${secCorrect}/5`;
  document.getElementById('totalCorrect').textContent = correct;
  document.getElementById('totalWrong').textContent = 10 - correct;
  document.getElementById('nota').textContent = nota + ' / 5.0';

  // Table
  const tbody = document.getElementById('resultTableBody');
  tbody.innerHTML = '';
  ALL_QUESTIONS.forEach((q, i) => {
    const a = answered[i];
    const selLabel = a !== null ? q.options[a.selected] : 'â€”';
    const correctLabel = q.options[q.answer];
    const ok = a && a.correct;
    tbody.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td>${q.type === 'arc' ? 'ğŸ”µ' : 'ğŸŸ¢'} P${i+1}</td>
        <td>${selLabel}</td>
        <td>${correctLabel}</td>
        <td class="${ok ? 'status-ok' : 'status-nok'}">${ok ? 'âœ”' : 'âœ˜'}</td>
      </tr>`;
  });

  document.getElementById('results-section').style.display = 'block';
  document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  EXCEL DOWNLOAD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function downloadExcel() {
  const correct = answered.filter(a => a && a.correct).length;
  const arcCorrect = answered.slice(0,5).filter(a => a && a.correct).length;
  const secCorrect = answered.slice(5,10).filter(a => a && a.correct).length;
  const nota = (correct / 10 * 5).toFixed(1);

  // Build CSV content (universally compatible)
  const rows = [
    ['RESULTADOS â€” TRIGONOMETRÃA GRADO 10Â°'],
    ['Longitud de Arco y Sector Circular'],
    [''],
    ['Nombre', studentData.name],
    ['CÃ³digo', studentData.code],
    ['Grado/Grupo', studentData.group],
    ['Fecha', studentData.date],
    [''],
    ['RESUMEN'],
    ['Longitud de arco', `${arcCorrect}/5`],
    ['Ãrea de sector', `${secCorrect}/5`],
    ['Total correctas', correct],
    ['Total incorrectas', 10 - correct],
    ['Nota (sobre 5.0)', nota],
    [''],
    ['#', 'Tipo', 'Pregunta resumen', 'Respuesta seleccionada', 'Respuesta correcta', 'Estado']
  ];

  const qNames = [
    'Hallar s â€“ r=9cm, Î¸=60Â°',
    'Hallar s â€“ r=6m, Î¸=120Â°',
    'Hallar r â€“ s=6Ï€ m, Î¸=90Â°',
    'Hallar r â€“ s=3Ï€ cm, Î¸=45Â°',
    'Hallar Î¸ â€“ r=5cm, s=5Ï€ cm',
    'Hallar A â€“ r=8cm, Î¸=90Â°',
    'Hallar A â€“ r=9m, Î¸=120Â°',
    'Hallar r â€“ A=6Ï€ mÂ², Î¸=60Â°',
    'Hallar r â€“ A=25Ï€ cmÂ², Î¸=90Â°',
    'Hallar Î¸ â€“ r=6cm, A=12Ï€ cmÂ²'
  ];

  ALL_QUESTIONS.forEach((q, i) => {
    const a = answered[i];
    const sel = a !== null ? q.options[a.selected] : 'Sin respuesta';
    const cor = q.options[q.answer];
    const ok = a && a.correct ? 'CORRECTO' : 'INCORRECTO';
    rows.push([i+1, q.type === 'arc' ? 'Longitud de arco' : 'Ãrea de sector', qNames[i], sel, cor, ok]);
  });

  // Convert to CSV
  const csv = rows.map(r => r.map(cell => `"${String(cell).replace(/"/g,'""')}"`).join(',')).join('\r\n');
  
  // BOM for Excel Spanish compatibility
  const bom = '\uFEFF';
  const blob = new Blob([bom + csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `Trigonometria10_${studentData.name.replace(/\s+/g,'_')}_${studentData.date}.csv`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);

  showToast('ğŸ“¥ Archivo descargado (Ã¡brelo en Excel)');
}

function resetQuiz() {
  answered = new Array(10).fill(null);
  studentData = {};
  document.getElementById('student-form-section').style.display = 'block';
  document.getElementById('progressArea').classList.remove('visible');
  document.getElementById('formulaRef').style.display = 'none';
  document.getElementById('submitRow').style.display = 'none';
  document.getElementById('results-section').style.display = 'none';
  document.getElementById('quiz-container').innerHTML = '';
  document.getElementById('studentName').value = '';
  document.getElementById('studentCode').value = '';
  document.getElementById('studentGroup').value = '';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.display = 'block';
  setTimeout(() => { t.style.display = 'none'; }, 3500);
}

// Set today's date
document.getElementById('studentDate').value = new Date().toISOString().slice(0,10);
</script>

<!-- FOOTER CREDIT -->
<footer class="app-footer">
  <div class="footer-inner">
    <div class="footer-logo">âœ¦</div>
    <div class="footer-text">
      <strong>Luis Jorge MillÃ¡n Bustamante</strong><br>
      Liceo Arquidiocesano de Nuestra SeÃ±ora &nbsp;Â·&nbsp; Manizales
    </div>
    <div class="footer-subject">TrigonometrÃ­a Â· Grado 10Â°</div>
  </div>
</footer>
</body>
</html>